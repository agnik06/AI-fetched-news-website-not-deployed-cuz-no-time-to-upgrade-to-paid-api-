<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI News Generator</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
    <header class="bg-dark text-white text-center py-3">
        <h1>AI News Generator</h1>
        <nav>
            <ul class="nav justify-content-center">
                <li class="nav-item"><a class="nav-link text-white" href="#">Home</a></li>
                <li class="nav-item"><a class="nav-link text-white" href="#">About</a></li>
                <li class="nav-item"><a class="nav-link text-white" href="#">Contact</a></li>
            </ul>
        </nav>
    </header>
    
    <main class="container mt-4">
        <section class="text-center">
            <h2>Welcome to AI News Generator</h2>
            <p>Fetching and summarizing AI-generated news with sentiment analysis.</p>
            <button id="googleSignIn" class="btn btn-danger">Sign in with Google</button>
            <button id="signOut" class="btn btn-secondary" style="display:none;">Sign Out</button>
            <p id="userWelcome" style="display:none;"></p>
            <button id="generateNews" class="btn btn-primary" style="display:none;">Generate News</button>
        </section>
        
        <section class="news mt-5">
            <h2 class="text-center">Latest News Generated by AI</h2>
            <div id="news-container" class="row mt-3"></div>
        </section>
    </main>
    
    <footer class="bg-dark text-white text-center py-3 mt-4">
        <p>&copy; 2025 AI News Generator. All rights reserved.</p>
    </footer>

    <!-- ✅ Load Firebase Script -->
    <script type="module">
        import { googleLogin, googleLogout } from "./firebase-config.js";

        document.getElementById('googleSignIn').addEventListener('click', googleLogin);
        document.getElementById('signOut').addEventListener('click', googleLogout);
    </script>

    <!-- ✅ News Fetching Script with Advanced Sentiment Analysis -->
    <script>
        document.getElementById("generateNews").addEventListener("click", fetchNews);

        function summarize(text, wordLimit = 15) {
    if (!text) return "No content available.";
    return text.split(" ").slice(0, wordLimit).join(" ") + "...";
}


        async function fetchNews() {
    try {
        const apiKey = "95cd49cd22c645debc5832ae480fdf5c";  // Replace with your actual NewsAPI key
        const response = await fetch(`https://newsapi.org/v2/top-headlines?country=us&apiKey=${apiKey}`);
        const data = await response.json();

        if (data.status !== "ok") {
            console.error("🔥 Error fetching news:", data);
            alert("Error fetching news. Check your API key or quota.");
            return;
        }

        const articles = data.articles.sort(() => Math.random() - 0.5).slice(0, 5); // Get 5 random articles
        const newsContainer = document.getElementById("news-container");
        newsContainer.innerHTML = ""; // Clear previous news

        for (let article of articles) {
            const summarizedText = summarize(article.description || article.content || "No content available.");
            const fullSummary = summarize(article.description || article.content || "No content available.", 40); // Longer summary for hover

            const sentiment = analyzeSentiment(summarizedText);
            const sentimentIndicator = getSentimentIndicator(sentiment);

            let bgColor = "bg-light";
            if (sentiment === "positive") bgColor = "bg-success text-white";
            else if (sentiment === "negative") bgColor = "bg-danger text-white";

            const newsTile = document.createElement("div");
            newsTile.classList.add("col-md-4", "mb-3");
            newsTile.innerHTML = `
                <div class="card ${bgColor} p-3 news-tile" data-summary="${fullSummary}">
                    <h5>${article.title}</h5>
                    <p>${summarizedText}</p>
                    <p><strong>Sentiment:</strong> ${sentimentIndicator}</p>
                    <a href="${article.url}" target="_blank" class="btn btn-light btn-sm">Read More</a>
                    <div class="news-summary-tooltip"></div>
                </div>
            `;
            newsContainer.appendChild(newsTile);
        }

        addHoverEffect(); // ✅ Enable the hover effect
    } catch (error) {
        console.error("🔥 News Fetch Error:", error);
        alert("Could not fetch news. Please check console for details.");
    }
}
function addHoverEffect() {
    const newsTiles = document.querySelectorAll(".news-tile");

    newsTiles.forEach(tile => {
        const tooltip = tile.querySelector(".news-summary-tooltip");

        tile.addEventListener("mouseenter", () => {
            const summaryText = tile.getAttribute("data-summary");
            tooltip.innerText = summaryText;
            tooltip.style.display = "block";

            // ✅ Reduce opacity of non-hovered tiles
            newsTiles.forEach(otherTile => {
                if (otherTile !== tile) {
                    otherTile.style.opacity = "0.5";  // Lighten other tiles
                }
            });
        });

        tile.addEventListener("mouseleave", () => {
            tooltip.style.display = "none";

            // ✅ Restore original opacity
            newsTiles.forEach(otherTile => {
                otherTile.style.opacity = "1";  // Reset opacity
            });
        });
    });
}

function analyzeSentiment(text) {
    // ✅ Define manual word corpus for sentiment analysis
    const positiveWords = [
    "good", "great", "excellent", "positive", "success", "happy", "joy", "improvement",
    "win", "profit", "growth", "fantastic", "amazing", "brilliant", "wonderful",
    "breakthrough", "best", "awesome", "celebration", "recovered", "peace", "agreement"
];

const negativeWords = [
    "bad", "worse", "worst", "negative", "failure", "crash", "decline", "down",
    "loss", "sad", "disaster", "horrible", "terrible", "awful", "inflation",
    "recession", "struggle", "weak", "violence", "war", "deported", "destroyed",
    "devastation", "damaged", "killed", "death", "crisis", "conflict"
];

    let score = 0;
    let words = text.toLowerCase().split(/\s+/);  // Split text into words

    for (let word of words) {
        if (positiveWords.includes(word)) score+=2;  // Increase score for positive words
        if (negativeWords.includes(word)) score-=2;  // Decrease score for negative words
    }

    // ✅ Determine final sentiment based on score
    if (score > 1) return "positive";
    if (score < -1) return "negative";
    return "neutral";  // Default to neutral if no strong sentiment is detected
}






        function getSentimentIndicator(sentiment) {
            if (sentiment === "positive") return "😊 Positive";
            if (sentiment === "negative") return "😞 Negative";
            return "😐 Neutral";
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
